<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Windows Privilege Escalation 101 - Hacking Notes</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Windows Privilege Escalation 101";
        var mkdocs_page_input_path = "Cheatsheets/Windows/101_windows.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/powershell.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Hacking Notes
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Welcome to MkDocs</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Cheatsheets</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">General</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../General/2022-07-30-file-transfers-101/">File Transfers 101</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/2022-07-30-pivot-101/">Pivoting & Lateral Movement</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/2022-08-07-auth-bypass-headers/">Auth Bypass Headers"</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/2022-10-04-pentesting-email-servers/">Email Pentesting</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/Kubernetes_Pentesting/">Pentesting Kubernetes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/cheatsheet_js/">Commands</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/hydra_cheat_sheet/">Hydra Cheat Sheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/msfvenom_cheatsheet/">MSFVenom Cheatsheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../General/splunk_cheat_sheet/">Splunk Cheatsheet</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Linux</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Linux/2022-07-30-x-without-y/">X Without Y (Living off the Land)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Linux/Powershell_Empire/">Powershell Empire</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Linux/linux/">Linux 101</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Windows</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Windows Privilege Escalation 101</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#user-accounts">User Accounts</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#service-accounts">Service Accounts</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#groups">Groups</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#regular-groups">Regular Groups</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#psuedo-groups">Psuedo Groups</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#resources">Resources</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#acls-aces">ACLs &amp; ACEs</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2022-07-09-impacket/">Impacket Toolset</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2022-07-10-bloodhound/">BloodHound</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2022-08-10-golden-ticket/">Golden Tickets</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2023-01-15-101_icalcs/">ICACLs 101</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Recon</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Recon/mapping/">Application Mapping</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Recon/recon/">Recon and Information Gathering</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Web</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Web/web_hacking/">Web Application Hacking</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Windows</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Windows/PowerShell/">PowerShell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Windows/windows_101/">Windows 101</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Hacking Notes</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Cheatsheets &raquo;</li>
          <li>Windows &raquo;</li>
      <li>Windows Privilege Escalation 101</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="windows-privilege-escalation-101">Windows Privilege Escalation 101</h1>
<h2 id="user-accounts">User Accounts</h2>
<p>These are the basic account(s) that you would use to log into a Windows machine.</p>
<p>They are a collection of settings/preferences bound to a unique identity. i.e. the username and the files linked to that account along with other preferences such as installed applications and group membership(s), all the various things that could be associated with a user account.</p>
<p>The local "Administrator" account is created by default during the installation process. It is not directly available to log in, similar to the <code>root</code> account on modern Linux systems, with the difference being that it can be activated using <code>net user administrator /active:yes</code> and it will become an account that appears on the login screen.</p>
<p>Depending on the version of Windows that is running there may be several other default User accounts such as "Guest".</p>
<h2 id="service-accounts">Service Accounts</h2>
<p>Used to run services (duh), services are programs that are being ran either constantly (in the case of web servers and FTP applications) or on a scheduled basis by a dedicated account with permissions set up specifically for that account. So in the case of the <code>NT AUTHORITY\IUSR</code> account which is used to control the IIS web service, it has specific permissions which allow it to manage the web server and all of it's associated functions. </p>
<p>They cannot be used to log in to Windows directly. But they are capable of granting a "user" shell, which will allow for access to the system but with generally limited capabilites and permissions.</p>
<p>The <code>NT AUTHORITY\SYSTEM</code> account is a default service account created during installation which has the highest privileges of any local account on Windows. It is the Windows equivalent of the "root" account and has <em>full</em> control over any application or user account on the system. In some instances it will even be a trusted account on other machines in the same network allowing for lateral movement.</p>
<p>There are other default service accounts that are created during the installation process, such as NETWORK SERVICE and LOCAL SERVICE, and the aforementioned IUSR.</p>
<h2 id="groups">Groups</h2>
<p>User accounts can belong to multiple groups, and groups can have multiple users (same as Linux). Not much else to explain here, just bear in mind that there are LOTS of groups on Windows systems, and especially when it comes to AD/Domain controllers you're going to have to get your reference sheets out and run things like <code>BloodHound</code> to map all of the interactions between the groups.</p>
<p>Groups allow for easier access control configuration by allowing multiple users the same level of access to a resource. We could created a group called "Tech_Admins" and give them access to restart/modify specific services and applications to allow them to perform maintenance or upgrades. </p>
<p>There are two types of groups:</p>
<h3 id="regular-groups"><em>Regular Groups</em></h3>
<p>These groups have a set list of members and are created by the domain or system Administrator(s), with the exception of the default groups such as "Users" which contain ALL regular (non-service) users of a system.</p>
<h3 id="psuedo-groups"><em>Psuedo Groups</em></h3>
<p>These groups have a dynamic list of users that can change based on certain interactions, i.e. the "Authenticated Users" group contains a list of members who are CURRENTLY authenticated to the system.</p>
<h2 id="resources">Resources</h2>
<p>Windows has a concept of resources known as Objects, there are multiple types of these:</p>
<ul>
<li>Files/Directories</li>
<li>Registry Entries</li>
<li>Services</li>
</ul>
<p>Everything is treated as an object and every object has a set of permissions attached to it. In most cases these are inherited from the parent directory but it is not allways the case and can lead to vulnerabilities we can take advantage of, and sometimes the inheritence itself is the thing we will look to take advantage of.</p>
<p>Whether a user has permission to perform certain actions on a resource will depend on what Groups that User is a member of and what permissions the User has.</p>
<pre><code class="language-bash">whoami          # computername\username
whoami /logonid # Gets the SID for our user
whoami /priv    # Permissions
whoami /groups  # Group Membership
whoami /all     # All the above at once
</code></pre>
<h2 id="acls-aces">ACLs &amp; ACEs</h2>
<p>Permissions to access resources (<em>Objects</em>) in Windows are controlled by the ACLs or Access Control Lists for that resource.</p>
<p>Each ACL is made up of zero or more access control entries (ACEs)</p>
<p>Each ACE define the relationship between a Principal (the name Windows uses for Users and Groups) and a certain access right.</p>
<p>To view the ACL for a particular Object you can use the GUI to open the Advanced Security Settings menu, or you can run the following command in PowerShell:</p>
<pre><code class="language-bash">Get-ACL &lt;file&gt;
</code></pre>
<pre><code class="language-bash">PS C:\Users\MrBullsec\Documents&gt; Get-Acl .\notes_checklist.md


    Directory: C:\Users\MrBullsec\Documents


Path               Owner         Access
----               -----         ------
notes_checklist.md CC1\MrBullsec NT AUTHORITY\SYSTEM Allow  FullControl...

</code></pre>
<p>or the following in CMD.exe:</p>
<pre><code class="language-bash">icacls &lt;file&gt;
</code></pre>
<pre><code class="language-bash">PS C:\Users\MrBullsec\Documents&gt; icacls .\notes_checklist.md
.\notes_checklist.md NT AUTHORITY\SYSTEM:(I)(F)
                     BUILTIN\Administrators:(I)(F)
                     CC1\MrBullsec:(I)(F)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../Linux/linux/" class="btn btn-neutral float-left" title="Linux 101"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../2022-07-09-impacket/" class="btn btn-neutral float-right" title="Impacket Toolset">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../Linux/linux/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../2022-07-09-impacket/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
